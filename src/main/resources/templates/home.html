<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Menadżer zadań</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
<!--    <script src="../static/script.js"></script>-->
</head>
<body>
<!--<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>-->

<div class="container text-center">
    <div class="row row-cols-auto">
    <h2>Menadżer zadań</h2>
    </div>
    <div class="row">
        <form class="row gy-2 gx-3 align-items-center" action="/add" method="post" th:object="${newTask}">
        <div class="col-auto">
        <input class="form-control" type="text" placeholder="Nazwa" th:field="*{title}">
        </div>
        <div class="col-auto">
        <input class="form-control" type="text" placeholder="Opis" th:field="*{description}">
        </div>
        <div class="col-auto">
        <input class="form-control" type="date" placeholder="Termin" th:field="*{dueDate}">
        </div>
        <div class="col-auto">
        <!--    <input type="text" placeholder="Data" th:field="*{date}">-->
        <select class="form-select" th:field="*{category}">
        <option value="0">--Wybierz kategorię--</option>
        <option th:each="cat: ${categories}"
                th:value="|${cat.id}|" th:text="|${cat.name}|"></option>
        </select>
        </div>
        <div class="col-auto">
        <input class="btn btn-primary" type="submit" value="Dodaj">
        </div>
    </form>
    </div>
    <div class="row">
        <form class="row gy-2 gx-3 align-items-center" action="/addCategory" method="post" th:object="${newCategory}">
        <div class="col-auto">
        <input id="categoryName" class="form-control" type="text" placeholder="Nowa kategoria" th:field="*{name}">
        </div>
        <div class="col-auto">
        <input onclick="categoryAdded()" class="btn btn-primary" type="submit" value="Dodaj kategorię">
        </div>
        </form>
    </div>
    <hr class="border border-info border-1 opacity-25">
    <div class="row">
        <table class="table table-hover">
        <thead>
        <tr class="table-info">
            <th scope="col">Zadanie</th>
            <th scope="col">Opis</th>
            <th scope="col">Termin</th>
            <th scope="col">Kategoria</th>
            <th scope="col">Zakończ bez logowania czasu</th>
            <th scope="col">Loguj czas</th>
            <th scope="col"></th>
            <th scope="col"></th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="task: ${tasks}" th:object="${task}">
            <td th:text="*{title}"></td>
            <td th:text="*{description}"></td>
            <td class="dueDateTask" th:text="*{dueDate}"></td>
            <td th:text="*{category.name}"></td>
            <td><form action="/done" method="post">
                <input type="hidden" name="id" th:value="${task.id}">
                <input type="hidden" name="done" th:value="${task.done}">
                <input name="taskDoneButton" class="btn btn-outline-secondary" type="submit" value="Zrobione"></form></td>
            <td><form action="/startTask" method="post">
                <input type="hidden" name="id" th:value="${task.id}">
                <input class="taskStartTime" type="hidden" name="startTime" th:value="${task.startTime}">
                <input type="hidden" name="endTime" th:value="${task.endTime}">
                <input name="taskStartButton" class="btn btn-outline-info" type="submit" value="Zaczynam"></form></td>
            <td><form action="/done" method="post">
                <input type="hidden" name="id" th:value="${task.id}">
                <input type="hidden" name="startTime" th:value="${task.startTime}">
                <input class="taskEndTime" type="hidden" name="endTime" th:value="${task.endTime}">
                <input type="hidden" name="done" th:value="${task.done}">
                <input name="taskEndButton" class="btn btn-outline-success" type="submit" value="Zakończ" disabled></form></td>
            <td><a class="link-underline-info"  th:href="|/edit?id=*{id}|">Edytuj</a></td>
        </tr>

        </tbody>
        </table>
    </div>
    <div class="row row-cols-auto">
    <p><a class="link-underline-secondary" href="/archive">Archiwum</a></p>
    </div>
</div>
<script src="/script.js"></script>
</body>
</html>